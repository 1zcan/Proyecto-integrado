{% extends "base.html" %}

{% block title %}Listado de Partos - HCHM{% endblock %}

{% block content %}

<div class="card shadow-sm border-0">
    
    <div class="card-header bg-white py-3">
        <div class="d-flex justify-content-between align-items-center">
            <h2 class="h5 mb-0">Listado de Partos Registrados</h2>
            <a href="{% url 'madre_lista' %}" class="btn btn-outline-secondary btn-sm">
                <i class="bi bi-arrow-left"></i> Volver al Listado de Madres
            </a>
        </div>
    </div>

    <div class="card-body">
        
        <form method="get" class="row g-3 align-items-end mb-4 parto-list-filters">
            <div class="col-md-3">
                <label class="form-label small">Fecha Desde</label>
                <input type="date" name="filtro_fecha_inicio" placeholder="Fecha Desde">
            </div>
            <div class="col-md-3">
                <label class="form-label small">Fecha Hasta</label>
                <input type="date" name="filtro_fecha_fin" placeholder="Fecha Hasta">
            </div>
            <div class="col-md-2">
                <label class="form-label small">Tipo</label>
                <select name="filtro_tipo">
                    <option value="">Todos los Tipos</option>
                    </select>
            </div>
            <div class="col-md-3">
                <label class="form-label small">Establecimiento</label>
                <select name="filtro_establecimiento">
                    <option value="">Todos los Establ.</option>
                    </select>
            </div>
            <div class="col-md-1">
                <button type="submit" class="btn btn-primary btn-sm w-100">Filtrar</button>
            </div>
        </form>

        <div class="table-responsive parto-list-table">
            <table class="table table-striped table-hover align-middle">
                <thead>
                    <tr>
                        <th>ID Parto</th>
                        <th>Madre (RUT)</th>
                        <th>Fecha/Hora</th>
                        <th>Tipo Parto</th>
                        <th>EG (sem)</th>
                        <th>Establecimiento</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for parto in partos %} 
                    <tr>
                        <td>{{ parto.id }}</td>
                        <td>{{ parto.madre.nombre_completo }} ({{ parto.madre.rut }})</td>
                        <td>{{ parto.fecha|date:"d-m-Y" }} {{ parto.hora }}</td>
                        <td>{{ parto.tipo_parto }}</td>
                        <td>{{ parto.edad_gestacional_semanas }}</td>
                        <td>{{ parto.establecimiento }}</td>
                        <td>
                            <a href="{% url 'parto_editar' pk=parto.pk %}" class="btn btn-sm btn-outline-primary" title="Registro ClÃ­nico">
                                <i class="bi bi-clipboard-data"></i>
                            </a>
                            <a href="{% url 'parto_modelo_atencion' pk=parto.pk %}" class="btn btn-sm btn-outline-secondary" title="REM A21">
                                <i class="bi bi-person-check"></i>
                            </a>
                            <a href="{% url 'parto_robson' pk=parto.pk %}" class="btn btn-sm btn-outline-secondary" title="Robson">
                                <i class="bi bi-bar-chart-steps"></i>
                            </a>
                            <a href="{% url 'parto_observaciones' parto_pk=parto.pk %}" class="btn btn-sm btn-outline-warning" title="Observaciones">
                                <i class="bi bi-eye"></i>
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7" class="text-center text-muted py-3">
                            No se encontraron registros de partos.
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}


{% block styles %}
<style>
   
    .parto-list-filters label {
        font-weight: 500;
        margin-bottom: 0.25rem;
    }

    .parto-list-filters input[type="date"],
    .parto-list-filters select {
        display: block;
        width: 100%;
        padding: 0.25rem 0.5rem; 
        font-size: .875rem; 
        font-weight: 400;
        line-height: 1.5;
        color: #212529;
        background-color: #fff;
        border: 1px solid #ced4da;
        border-radius: 0.375rem;
        transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;
    }

    .parto-list-filters select {
        padding-right: 2rem; 
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 0.5rem center;
        background-size: 16px 12px;
    }

    .parto-list-filters input:focus,
    .parto-list-filters select:focus {
        border-color: #007bff;
        outline: 0;
        box-shadow: 0 0 0 0.25rem rgba(0, 123, 255, 0.25);
    }

   
    .parto-list-table table thead {
        background-color: #f8f9fa;
        border-bottom: 1px solid #dee2e6;
    }
    
    .parto-list-table table th {
        font-weight: 500;
        color: #495057;
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        padding: 0.75rem 1rem;
        vertical-align: middle;
    }

    .parto-list-table table td {
        padding: 0.75rem 1rem;
        font-size: 0.9rem;
        vertical-align: middle;
    }

   
    .parto-list-table .btn {
        margin-right: 4px;
    }
</style>
{% endblock %}