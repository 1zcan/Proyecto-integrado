{% extends "base.html" %}

{% block title %}Dashboard - Sistema Perinatal{% endblock %}

{% block content %}

<div class="container mt-5">
    {% with rol=user.perfil.rol %}
    
    <div class="row g-4">

        {# 1. GESTIÓN DE USUARIOS (Solo TI) #}
        {% if rol == 'ti_informatica' %}
        <div class="col-md-6 col-lg-4">
            {# ANTES: usuarios:registro #}
            <a href="{% url 'usuarios:gestion_usuarios' %}" class="card-link">
                <div class="card h-100 p-3 border-warning">
                    <div class="card-body">
                        <div class="card-icon icon-orange">
                            <i class="bi bi-shield-lock"></i>
                        </div>
                        <h5 class="card-title">Gestión de Usuarios</h5>
                        <p class="card-text text-muted">
                            Crear cuentas, asignar roles y seguridad.
                        </p>
                    </div>
                </div>
            </a>
        </div>
        {% endif %}

        {# 2. AUDITORÍA (Solo TI) #}
        {% if rol == 'ti_informatica' %}
        <div class="col-md-6 col-lg-4">
            <a href="{% url 'auditoria:log_list' %}" class="card-link">
                <div class="card h-100 p-3 border-danger">
                    <div class="card-body">
                        <div class="card-icon icon-red">
                            <i class="bi bi-journal-text"></i>
                        </div>
                        <h5 class="card-title">Registro de Auditoría</h5>
                        <p class="card-text text-muted">
                            Visualizar logs de acciones críticas y eliminaciones.
                        </p>
                    </div>
                </div>
            </a>
        </div>
        {% endif %}

        {# 3. GESTIÓN DE MADRES (Admisión, Clínicos y TI) #}
        {% if rol == 'administrativo' or rol == 'profesional_salud' or rol == 'tecnico_salud' or rol == 'ti_informatica' %}
        <div class="col-md-6 col-lg-4">
            {# ANTES: 'madre_lista' sin namespace #}
            <a href="{% url 'madre:madre_lista' %}" class="card-link">
                <div class="card h-100 p-3">
                    <div class="card-body">
                        <div class="card-icon icon-pink">
                            <i class="bi bi-people"></i>
                        </div>
                        <h5 class="card-title">Gestión de Madres</h5>
                        <p class="card-text text-muted">
                            {% if rol == 'administrativo' %}
                                Ingreso de admisión y datos demográficos.
                            {% else %}
                                Fichas maternas, antecedentes y admisión.
                            {% endif %}
                        </p>
                    </div>
                </div>
            </a>
        </div>
        {% endif %}

        {# 4. GESTIÓN DE PARTOS (Clínicos y TI) #}
        {% if rol == 'profesional_salud' or rol == 'tecnico_salud' or rol == 'ti_informatica' %}
        <div class="col-md-6 col-lg-4">
            {# ANTES: 'parto_lista' sin namespace #}
            <a href="{% url 'parto:parto_lista' %}" class="card-link">
                <div class="card h-100 p-3">
                    <div class="card-body">
                        <div class="card-icon icon-green">
                            <i class="bi bi-heart-pulse"></i>
                        </div>
                        <h5 class="card-title">Gestión de Partos</h5>
                        <p class="card-text text-muted">
                            Historial de partos, Robson, Modelo de Atención y Firmas.
                        </p>
                    </div>
                </div>
            </a>
        </div>
        {% endif %}

        {# 5. RECIÉN NACIDO (Clínicos y TI) #}
        {% if rol == 'profesional_salud' or rol == 'tecnico_salud' or rol == 'ti_informatica' %}
        <div class="col-md-6 col-lg-4">
            <a href="{% url 'recien_nacido:rn_lista' %}" class="card-link">
                <div class="card h-100 p-3">
                    <div class="card-body">
                        <div class="card-icon icon-blue">
                            <i class="bi bi-clipboard-plus"></i>
                        </div>
                        <h5 class="card-title">Recién Nacido</h5>
                        <p class="card-text text-muted">
                            Atención inmediata, vacunas y validación de alta.
                        </p>
                    </div>
                </div>
            </a>
        </div>
        {% endif %}

        {# 6. REPORTES (Profesional y TI) #}
        {% if rol == 'profesional_salud' or rol == 'ti_informatica' %}
        <div class="col-md-6 col-lg-4">
            <a href="{% url 'reportes:reportes_menu' %}" class="card-link">
                <div class="card h-100 p-3">
                    <div class="card-body">
                        <div class="card-icon icon-purple">
                            <i class="bi bi-file-earmark-bar-graph"></i>
                        </div>
                        <h5 class="card-title">Reportes REM</h5>
                        <p class="card-text text-muted">
                            Generación de reportes estadísticos ministeriales.
                        </p>
                    </div>
                </div>
            </a>
        </div>
        {% endif %}

    </div>
    {% endwith %}
</div>

<style>
    body { background-color: #f8f9fa; }
    
    .card-icon {
        font-size: 2.5rem;
        padding: 1rem;
        border-radius: 0.5rem;
        display: inline-block;
        margin-bottom: 1rem;
    }
    
    /* Colores de iconos */
    .icon-pink { color: #d63384; background-color: #fce6f0; }
    .icon-blue { color: #0d6efd; background-color: #e7f0ff; }
    .icon-purple { color: #6f42c1; background-color: #f1eefe; }
    .icon-green { color: #198754; background-color: #e8f3ee; }
    .icon-orange { color: #fd7e14; background-color: #fff3cd; }
    .icon-red { color: #dc3545; background-color: #f8d7da; }

    .border-warning { border: 1px solid #ffc107 !important; }
    .border-danger { border: 1px solid #dc3545 !important; }

    .card {
        border: none;
        box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        transition: transform 0.2s;
    }
    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    }
    .card-link { text-decoration: none; color: inherit; }
    .card-link:hover .card-title { color: #0d6efd; }
    .card-title { font-weight: 600; }
</style>
{% endblock %}
